																											<!DOCTYPE html>
<!-------------------------------------------------------------
 Name:        Explore Holiday Packages
 Purpose:     TO explore the world
 Author:      sushanth
 Created:     18-08-2013
 Modified:    15-07-2015
 Copyright:  (c) Explore Holiday Packages
--------------------------------------------------------------->
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer.">
    <meta name="author" content="Sushanth">
    <meta http-equiv="refresh" content="600">
    <meta name="keywords" content="holiday,vacation,resort,club membership, Bangalore">
    <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.css">    
    <link rel="stylesheet" type="text/css" media="screen" href="css/docs.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/pin.css">
	<link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="css/community.css">
	<link rel="stylesheet" type="text/css" media="screen" href="css/custom-platform-style.min.css">
	<link rel="stylesheet" type="text/css" media="screen" href="http://fortawesome.github.io/Font-Awesome/assets/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" media="screen" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css">
    <script type="text/javascript" src="javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/d3.v3.min_b.js"></script>
    <link rel="shortcut icon" href="/./images/images.jpg">
	<meta property="og:title"  content="Explore Holiday Packages" /> 
    <meta property="og:url"   content="http://exploreholidaypackages.github.io" /> 
    <meta property="og:description" content="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." /> 
    <meta property="og:image" content="http://exploreholidaypackages.github.io//images/home.jpg" /> 
    <html itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="description" content="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer.">
    <meta itemprop="name" content="Explore Holiday Packages">
    <meta itemprop="image" content="http://exploreholidaypackages.github.io//images/home.jpg">
	<script type="text/javascript">var switchTo5x=true;</script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">stLight.options({publisher: "cc30e3a2-dbb5-4545-ac40-64ca85fe3e37", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script> 	
    <title>Explore Holiday Packages</title>
    </head>
	<style>
	h3 {
		font-family: Arial, Helvetica, sans-serif;
		color:'#ccc'
	}
	</style>
    <body class="theme-beige" >
   <!-- HEADER -->
    <div id="header_wrap" class="outer info">
        <header class="inner">
            <h1 align="left" id="project_title"><a class="fa fa-home fa-12" id="home" href="/./" ></a>&nbsp;&nbsp;&nbsp;Explore Holiday Packages</h1>
            <p id="project_title_p">Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer.</p>
        </header>
    </div>
	<div class="inner head">
	<div class="row"><div class="col-md-8"><div class="panel panel-default"><div class="panel-body">
	<p  align="center" class="form-inline">
		<span st_url='http://exploreholidaypackages.github.io/' st_title = 'Explore Holiday Packages' st_image='http://exploreholidaypackages.github.io//images/home.jpg'  st_summary="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." class='st_facebook_hcount' displayText='Facebook'></span>
		<span st_url='http://exploreholidaypackages.github.io/' st_title = 'Explore Holiday Packages' st_image='http://exploreholidaypackages.github.io//images/home.jpg'  st_summary="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." class='st_twitter_hcount' displayText='Tweet'></span>
		<span st_url='http://exploreholidaypackages.github.io/' st_title = 'Explore Holiday Packages' st_image='http://exploreholidaypackages.github.io//images/home.jpg'  st_summary="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." class='st_linkedin_hcount' displayText='LinkedIn'></span>
	    <span st_url='http://exploreholidaypackages.github.io/' st_title = 'Explore Holiday Packages' st_image='http://exploreholidaypackages.github.io//images/home.jpg'  st_summary="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." class='st_googleplus_hcount' displayText='Google'></span>
		<span st_url='http://exploreholidaypackages.github.io/' st_title = 'Explore Holiday Packages' st_image='http://exploreholidaypackages.github.io//images/home.jpg'  st_summary="Exploring the world is our passion, and we want to share the joys of discovery with you through the diversity of the resorts we offer." class='st_email_hcount' displayText='Email'></span>
	</p>
	</div></div></div></div>
    <div id="list" >
        <div class="menu3-container"></div>
    </div>
    </div>
			
    <script src="javascripts/jquery.min.js"></script>
    <script src="javascripts/bootstrap.min.js"></script>
<script type="text/javascript">

    $(window).scroll(function() {
        if ($(this).scrollTop() >= 50) {        
            $('#return-to-top').fadeIn(200);    
        } else {
            $('#return-to-top').fadeOut(200);   
        }
    });
    $('#return-to-top').click(function() {     
        $('body,html').animate({
            scrollTop : 0             
        }, 500);
    });
    
    var splitChar = '; ';
    var json;

    var data1 = {
        class_name :"displayName",
        href: function(d, i){return '#'+ d.dimension+'=all';},
        html: function(d, i){ return d.displayName;}
    };

    var data2 = {
        class_name :"displayName",
        href: function(d, i){ return '#'+ d.dimension+'='+d.key; },
        html: function(d, i){ return d.key+' <span class="value">'+ d.value+'</span>';}
    };

    var data3 = {
        class_name :"just",
       			
		html: function(d, i){
            var 
			content = '<div class="row"><h3 align="center"> Resort : '+d['Resort_Name'].toUpperCase()+'</h3></div> <br/>';
			//<div class="col-md-3"><div class="panel panel-default"><div class="panel-heading">Images</div><div class="panel-body"><img width="192" height="128"  src='+d['image_0']+' id="grey_scale"  class="visual-img "/></div></div></div>';
			content += '<div class="row"><div class="col-md-3"><div class="panel panel-default"><div class="panel-heading">Images</div><div class="panel-body"><img width="192" height="128"  src='+d['image_0']+' id="grey_scale"  class="visual-img "/></div></div></div>';
			content += '<div class="col-md-3"><div class="panel panel-default"><div class="panel-heading">Images</div><div class="panel-body"><img width="192" height="128"  src='+d['image_1']+' id="grey_scale"  class="visual-img "/></div></div></div>';
			content += '<div class="col-md-6"><div class="panel panel-default"><div class="panel-heading">Location</div><div class="panel-body"><p>For Enquiry : Explore Holiday Packages <br/> $90 (approx) per day for a two-sharing 5 star <br/> click <a href="'+d['Map']+'">here</a>for map location <br/>mail us @ exploreholidaypackages@gmail.com <br/> contact us @ 91 - 9444583307</p></div></div></div></div>';
			content +='<div class="row"> <div class="col-md-6"><div class="panel panel-default"><div class="panel-heading">About </div><div class="panel-body">';
            content += "<p>"+d['About']+"<p/>";
            content += '</div></div></div><div class="col-md-2"><div class="panel panel-default"><div class="panel-heading">Amenities </div><div class="panel-body">';
            content += "<p>"+d['Amenities']+"<p/>";
			content += '</div></div></div><div class="col-md-2"><div class="panel panel-default"><div class="panel-heading">Directions </div><div class="panel-body">';
            content += "<p>"+d['Directions']+"<p/>";
			content += '</div></div></div><div class="col-md-2"><div class="panel panel-default"><div class="panel-heading">Other Information </div><div class="panel-body">';
            content += "<p>"+d['Other Information']+"<p/></div></div></div></div>";			
		  	return content;}
    };
	


    function getDocHeight() {
        var doc = document;
        return Math.max(
            doc.body.scrollHeight, doc.documentElement.scrollHeight,
            doc.body.offsetHeight, doc.documentElement.offsetHeight,
            doc.body.clientHeight, doc.documentElement.clientHeight
        );
    }

    var thumbSize = 250;
    var menu3Width = parseInt(d3.select('#list').style('width'));
    var numInOneScreen = Math.ceil(menu3Width / thumbSize) * Math.ceil(getDocHeight() / thumbSize);
    var numInView = numInOneScreen;

    d3.csv('detail_data_all.csv', function(error, _json){
        json = _json;
        buildList(dataTransformMenu1(), '.menu1-container', data1);
        buildList(dataTransformMenu2('Country'), '.menu2-container', data2);
        processLocationHash();
    });

    function dataTransformMenu1(){
        //TODO: change in spreadsheet
        var dimensionsMap = {Country: 'Country', City: 'City'};
        return d3.keys(dimensionsMap).map(function(d, i){return {dimension: d, displayName: dimensionsMap[d]};});
    }

    function dataTransformMenu2(dimension, filter){
        var splitted = d3.merge(json.map(function(d, i){
            return splitter(d[dimension]);
        }));
        var filtered = (filter) ? splitted.filter(function(d, i){ return d.toLowerCase().indexOf(filter.toLowerCase()) != -1; }) : splitted;
        var unemptied = filtered.map(function(d, i){return (d == '') ? 'untagged' : d;});
        var grouped = groupCount(unemptied);
        var prepared = d3.entries(grouped).map(function(d, i){
                d.dimension = dimension;
                return d;
            });
        var sorted = prepared.sort(function(a, b){return b.value - a.value});
        return sorted;
    }

    function splitter(data){
        return (data.indexOf(splitChar) !== -1) ? data.split(splitChar) : data;
    }

    function groupCount(arr) {
        var uniques = {}, val;
        var dups = {};
        for (var i = 0, len = arr.length; i < len; i++) {
            val = arr[i];
            if (val in uniques) {
                uniques[val]++;
                dups[val] = uniques[val];
            } else uniques[val] = 1;
        }
        return(uniques);
    }

    var cachedData;
    function dataTransformMenu3(dimension, value){
        var filtered = json.filter(function(d, i){
            var splitted = splitter(d[dimension]);
            if (value == 'all') return true;
            else if(value == 'untagged') return (splitted == '');
            //TODO: use the grouped data instead
            else if(splitted.indexOf(value) >= 0) return true;
            else return false;
        });
        var sorted = filtered.sort(function(a, b){
                return (a.thumbnail == '') - (b.thumbnail == '');
            });
        cachedData = sorted;
        return sorted;
    }

    function dataView(data, num){
        return data.slice(0, num);
    }

    function buildList(data, containerSelector, content){
        d3.select(containerSelector).selectAll("li.entry").remove();
        updateList(data, containerSelector, content);
    }

    function updateList(data, containerSelector, content){
        var entries = d3.select(containerSelector)
            .selectAll("li.entry")
            .data(data)
            .enter().append("li")
            .attr('class', 'entry')
            .append('a')
            .attr('href', content.href)
            .attr('class',content.class_name)
            .html(content.html);
    }

    d3.select('.menu2-search')
        .on('change', function(d, i){ filterList(this.value); })
        .on('keyup', function(d, i){ filterList(this.value); });
    d3.select('body').on('mouseover', function(){
            if (d3.event.target.nodeName == 'A') d3.select('.menu2-search').node().blur();
        });

    function filterList(value){
        var dimension = window.location.hash.substring(1).split('=')[0] || 'Country';
        buildList(dataTransformMenu2(dimension, value), '.menu2-container', data2);
    }

    function processLocationHash(){
        d3.select('#list').node().scrollTop = 0;
        numInView = numInOneScreen;
        if(window.location.hash) {
            var hash = window.location.hash.substring(1);
            var hashSplit = hash.split('=');
            if(hashSplit[1] == 'all') buildList(dataTransformMenu2(hashSplit[0]), '.menu2-container', data2);
            buildList(dataView(dataTransformMenu3(hashSplit[0], hashSplit[1]), numInView), '.menu3-container', data3);
        }else{
            buildList(dataView(dataTransformMenu3('City', 'all'), numInView), '.menu3-container', data3);
        }
    }

    d3.select(window).on('hashchange', function () {
        processLocationHash();
    });

    d3.select('#list').on('scroll', function(d, i){
        if(this.scrollHeight - this.scrollTop <= getDocHeight()){
            numInView += numInOneScreen;
            updateList(dataView(cachedData, numInView), '.menu3-container', data3);
        }
    });

</script>	
<footer>
<div class="row">
	<nav class="navbar" role="navigation">
		<div class="container">
			<!-- logo -->
				<div class="col-sm-2 col-lg-2">
				</div>
		</div>
	</nav>
        <div class="copyright text-center">
			@ 2015 Explore Holiday Packages Private Limited. All rights reserved
		</div>
</div>
</footer>   	
</body>
</html>
